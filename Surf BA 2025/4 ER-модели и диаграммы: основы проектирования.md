Источник: https://vk.com/video-42908247\_456239484   

# 4. ER-модели и диаграммы: основы проектирования   
## 4.1. ER-модель   
### 4.1.1. Entity-Relationship модель   
Во многих проектах есть данные, которые нужно хранить в БД. Например, артикул товара, его название и цена. В этом примере ариткул, название и цена — это сущности, а отношения между ними — это связь.   
ER-модель — это способ представить логическую структуру данных в виде сущностей (Entity), их атрибутов (Attribute) и связей (Relationship).   

ER-модель нужна, чтобы показать какие данные у нас есть и как они связаны. Это помогает избежать ошибок на самом старте проекта и вырабатывает универсальный язык общения между бизнесом и разработкой. Используется на этапе проектирования баз данных.   
Может создаваться как бизнес/системным-аналитиком, так и архитектором.   
3 уровня моделей:   
  1. Концептуальный — верхнеуровневая модель, чтобы показать предметную область проекта. Например, касса, товар, заказ, покупатель. Нужна для системного аналитика и заказчика, чтобы проверить, все ли требования учтены.    
  2. Логический — детализация концептуальной модели, добавление характеристик, атрибутов. Например, к сущности "товар" добавляем атрибуты "название", "цена" и "артикул". Составляет системный аналитик и архитектор.   
  3. Физический — как будет организована работа с данными. Выбирается тип БД, её содержание и где будут храниться данные.   

### 4.1.2. Компоненты ER-модели   
- Сущность (Entity) — объект, о котором нужно хранить данные; объект реального мира, который можно идентифицировать и о котором можно собрать данные   
    - Сильная сущность — есть уникальный ключ   
    - Слабая сущность — не имеет уникального ключа; обычно имеет связь с сильной сущностью   
- Атрибут (Attribute) — характеристика и свойства сущности   
    - Простые атрибуты — характеристику нельзя поделить; например, возраст   
    - Составные атрибуты — состоят из других атрибутов; например, адрес    
    - Однозначные атрибуты — имеют одно значение    
    - Множественные атрибуты — имеют несколько значений; например, человек может обладать несколькими телефонными номерами   
    - Ключевые атрибуты — уникальный идентификатор   
- Связь (Relationship) — логическая ассоциация между сущностями 
- Ключ (Primary key) — уникальный идентификатор сущности   
   
### 4.1.3. Атрибуты и типы данных   
Атрибут — это характеристика сущности (например, имя, цена, дата). Для каждого атрибута мы назначаем тип данных.   
Тип данных определяет, что именно может храниться в поле:   
  - INTEGER — целое число (ID, количество)
  - DECIMAL / FLOAT — число с точкой (цена, вес)
  - VARCHAR — строка (имя, штрихкод)
  - BOOLEAN — да/нет (например, «в наличии»)
  - DATE / DATETIME — дата или дата и время   

Выбор типа данных влияет на:   
  - целостность данных — в поле "цена" нельзя добавить буквенный символ      
  - производительность — если мы знаем, что какое-то значение будет всегда находиться в определённом диапазоне, то мы можем хранить это значение в подходящем типе, чтобы, например, ускорить поиск по элементу или экономить память   
  - логику валидации — целым числам можно задать ограничения, а строкам задать маску через RegExp   
  - бизнес-правила   

Пример концептуальной ER-модели:   
![image](files/image.png)    
### 4.1.4. Типы связей в ER-модели   
В ER-моделировании различают три основных типа связей:   
  - Один к одному (1:1). Каждая сущность A связана не более чем с одной сущностью B, и наоборот. Например, таблицы "Человек" и "Паспортные данные": одному человеку соответствует только один набор паспортных данных и один набор паспортных данных соответствует только одному человеку
  - Один ко многим (1:N). Одна сущность A может быть связана с несколькими сущностями B, но B — только с одной A. Например, таблицы "Покупатель" и "Заказы": у одного покупателя может быть много заказов, но заказ принадлежит только одному покупателю
  - Многие ко многим (M:N). Одна сущность A может быть связана с несколькими B, и наоборот. Например, таблица "Товары" и "Заказы": один товар может быть во множестве заказов и один заказ может содержать множество товаров   

### 4.1.5. Ключи в ER-модели: Primary Key и Foreign Key   
Нормализация БД — установка связи между сущностями через ключи   

Primary Key (Первичный ключ)   
  - Уникальный идентификатор записи в таблице   
  - Не может быть пустым
   
Foreign Key (Внешний ключ)   
  - Ссылается на первичный ключ другой таблицы
  - Создаёт связь между сущностями   

## 4.2. ER-диаграмма   
### 4.2.1. ER-диаграмма   
ER-модель — это общее представление данных, ER-диаграмма — графическое представление модели, а нотация — графический язык для представления модели.    

Нотации:
  - Нотация Чена: подходит для создания концептуальных моделей и демонстрации заказчику   
  - Нотация Мартина: подходит для логический моделей   

### 4.2.2. Элементы нотации Чена и Мартина   
![image](files/image_q.png)    

### 4.2.3. Элементы нотации Мартина   
![image](files/image_g.png)    
![image](files/image_d.png)    

### 4.2.4. Полезные материалы   
- Яндекс.Практикум: [Сущности и связи: как и для чего системные аналитики создают ER‑диаграммы](https://practicum.yandex.ru/blog/chto-takoe-er-diagramma/)   
- Analyst.by: [Логическая модель предметной области](http://analyst.by/diagrams/logicheskaya-model-predmetnoy-oblasti)   
- Habr — WolfffR: [Семантическое моделирование. Проектирование БД с помощью ER-модели](https://habr.com/ru/companies/timeweb/articles/916824/)   
- Бизнес-секреты: [Как использовать ER-диаграммы в бизнесе](https://secrets.tbank.ru/glossarij/er-diagramma/)   
- Microsoft Learn: [Описание основных приемов нормализации базы данных](https://learn.microsoft.com/ru-ru/office/troubleshoot/access/database-normalization-description)   
